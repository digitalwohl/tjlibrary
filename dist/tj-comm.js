function t(n,i){return t=Object.setPrototypeOf||function(t,n){return t.__proto__=n,t},t(n,i)}let n=t=>crypto.getRandomValues(new Uint8Array(t));var i=/*#__PURE__*/function(){function t(t,n,i){this.STRING_SEPARATOR="#",this.id=void 0,this.domain=void 0,this.action=void 0,this.data=void 0,this.domain=t,this.action=n,this.data=i,this.id=this.generateId()}var i=t.prototype;return i.generateId=function(){return((t,n,i)=>{let o=(2<<Math.log(t.length-1)/Math.LN2)-1,r=-~(1.6*o*16/t.length);return()=>{let n="";for(;;){let s=i(r),e=r;for(;e--;)if(n+=t[s[e]&o]||"",16===n.length)return n}}})("1234567890",0,n)()},i.toString=function(){return""+this.id+this.STRING_SEPARATOR+this.domain+this.STRING_SEPARATOR+this.action},t}(),o=/*#__PURE__*/function(){function t(){this.PARENT_TARGET_ORIGIN="https://localhost/tabjail/sandbox"}return t.prototype.sendSandboxEvent=function(t){window.parent.postMessage(t.toString(),this.PARENT_TARGET_ORIGIN)},t}(),r=/*#__PURE__*/function(){function t(t){this.resolve=void 0,this.reject=void 0,this.sandboxEvent=void 0,this.sandboxEvent=t}var n=t.prototype;return n.createPromise=function(){var t=this;return new Promise(function(n,i){t.resolve=n,t.reject=i})},n.resolvePromise=function(t){this.resolve(t)},n.rejectPromise=function(t){this.reject(t)},t}(),s=/*#__PURE__*/function(n){var o,s;function e(){for(var t,i=arguments.length,o=new Array(i),r=0;r<i;r++)o[r]=arguments[r];return(t=n.call.apply(n,[this].concat(o))||this).DOMAIN="extension",t.ACTIONS={GET_ALL_WINDOWS:"getAllWindows",ON_BOUNDS_CHANGED_WINDOWS:"onBoundsChangedWindows",ON_CREATED_WINDOWS:"onCreatedWindows",ON_FOCUS_CHANGED_WINDOWS:"onFocusChangedWindows",ON_REMOVED_WINDOWS:"onRemovedWindows"},t.pendingRequests=void 0,t.onBoundsChangedCallbacks=void 0,t.onCreatedCallbacks=void 0,t.onFocusChangedCallbacks=void 0,t.onRemovedCallbacks=void 0,t}s=n,(o=e).prototype=Object.create(s.prototype),o.prototype.constructor=o,t(o,s);var u=e.prototype;return u.getAll=function(){try{var t=this,n=new i(t.DOMAIN,t.ACTIONS.GET_ALL_WINDOWS),o=new r(n);t.pendingRequests.push(o),t.sendSandboxEvent(n);var s=o.createPromise();return Promise.resolve(s)}catch(t){return Promise.reject(t)}},u.onBoundsChanged=function(t){this.onBoundsChangedCallbacks.push(t)},u.onCreated=function(t){this.onCreatedCallbacks.push(t)},u.onFocusChanged=function(t){this.onFocusChangedCallbacks.push(t)},u.onRemoved=function(t){this.onRemovedCallbacks.push(t)},u.onEventFromSandbox=function(t){if(t.domain===this.DOMAIN)switch(t.action){case this.ACTIONS.GET_ALL_WINDOWS:var n=this.pendingRequests.find(function(n){return n.sandboxEvent.id===t.id});n&&n.resolvePromise(t);break;case this.ACTIONS.ON_BOUNDS_CHANGED_WINDOWS:this.onBoundsChangedCallbacks.forEach(function(n){return n(t.data)});break;case this.ACTIONS.ON_CREATED_WINDOWS:this.onCreatedCallbacks.forEach(function(n){return n(t.data)});break;case this.ACTIONS.ON_FOCUS_CHANGED_WINDOWS:this.onFocusChangedCallbacks.forEach(function(n){return n(t.data)});break;case this.ACTIONS.ON_BOUNDS_CHANGED_WINDOWS:this.onRemovedCallbacks.forEach(function(n){return n(t.data)})}},e}(o),e=/*#__PURE__*/function(){function t(){this.windows=new s}return t.prototype.onEventFromSandbox=function(t){this.windows.onEventFromSandbox(t)},t}(),u=/*#__PURE__*/function(){function t(){}return t.onEventFromSandbox=function(t){this.chrome.onEventFromSandbox(t)},t}();u.chrome=new e,exports.TJ=u,exports.listenForSandboxEvents=function(){window.addEventListener("message",function(t){u.onEventFromSandbox(t.data)},!1)};
//# sourceMappingURL=tj-comm.js.map
