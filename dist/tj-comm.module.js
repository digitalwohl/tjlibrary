function t(n,i){return t=Object.setPrototypeOf||function(t,n){return t.__proto__=n,t},t(n,i)}let n=t=>crypto.getRandomValues(new Uint8Array(t));var i=/*#__PURE__*/function(){function t(t,n,i){this.id=void 0,this.domain=void 0,this.action=void 0,this.data=void 0,this.domain=t,this.action=n,this.data=i,this.id=this.generateId()}return t.prototype.generateId=function(){return((t,n,i)=>{let o=(2<<Math.log(t.length-1)/Math.LN2)-1,r=-~(1.6*o*16/t.length);return()=>{let n="";for(;;){let s=i(r),u=r;for(;u--;)if(n+=t[s[u]&o]||"",16===n.length)return n}}})("1234567890",0,n)()},t}(),o=/*#__PURE__*/function(){function t(){this.PARENT_TARGET_ORIGIN="https://localhost/tabjail/sandbox"}return t.prototype.sendSandboxEvent=function(t){window.parent.postMessage(t,this.PARENT_TARGET_ORIGIN)},t}(),r=/*#__PURE__*/function(){function t(t){this.resolve=void 0,this.reject=void 0,this.sandboxEvent=void 0,this.sandboxEvent=t}var n=t.prototype;return n.createPromise=function(){var t=this;return new Promise(function(n,i){t.resolve=n,t.reject=i})},n.resolvePromise=function(t){this.resolve(t)},n.rejectPromise=function(t){this.reject(t)},t}(),s=/*#__PURE__*/function(n){var o,s;function u(){for(var t,i=arguments.length,o=new Array(i),r=0;r<i;r++)o[r]=arguments[r];return(t=n.call.apply(n,[this].concat(o))||this).DOMAIN="extension",t.ACTIONS={GET_ALL_WINDOWS:"getAllWindows",ON_BOUNDS_CHANGED_WINDOWS:"onBoundsChangedWindows",ON_CREATED_WINDOWS:"onCreatedWindows",ON_FOCUS_CHANGED_WINDOWS:"onFocusChangedWindows",ON_REMOVED_WINDOWS:"onRemovedWindows"},t.pendingRequests=[],t.onBoundsChangedCallbacks=[],t.onCreatedCallbacks=[],t.onFocusChangedCallbacks=[],t.onRemovedCallbacks=[],t}s=n,(o=u).prototype=Object.create(s.prototype),o.prototype.constructor=o,t(o,s);var e=u.prototype;return e.getAll=function(){var t=new i(this.DOMAIN,this.ACTIONS.GET_ALL_WINDOWS),n=new r(t);return this.pendingRequests.push(n),this.sendSandboxEvent(t),n.createPromise()},e.onBoundsChanged=function(t){this.onBoundsChangedCallbacks.push(t)},e.onCreated=function(t){this.onCreatedCallbacks.push(t)},e.onFocusChanged=function(t){this.onFocusChangedCallbacks.push(t)},e.onRemoved=function(t){this.onRemovedCallbacks.push(t)},e.onEventFromSandbox=function(t){if(t.domain===this.DOMAIN)switch(t.action){case this.ACTIONS.GET_ALL_WINDOWS:var n=this.pendingRequests.find(function(n){return n.sandboxEvent.id===t.id}),i=this.pendingRequests.findIndex(function(n){return n.sandboxEvent.id===t.id});n&&(n.resolvePromise(t.data),this.pendingRequests.splice(i,1));break;case this.ACTIONS.ON_BOUNDS_CHANGED_WINDOWS:this.onBoundsChangedCallbacks.forEach(function(n){return n(t.data)});break;case this.ACTIONS.ON_CREATED_WINDOWS:this.onCreatedCallbacks.forEach(function(n){return n(t.data)});break;case this.ACTIONS.ON_FOCUS_CHANGED_WINDOWS:this.onFocusChangedCallbacks.forEach(function(n){return n(t.data)});break;case this.ACTIONS.ON_BOUNDS_CHANGED_WINDOWS:this.onRemovedCallbacks.forEach(function(n){return n(t.data)})}},u}(o),u=/*#__PURE__*/function(){function t(){this.windows=new s}return t.prototype.onEventFromSandbox=function(t){this.windows.onEventFromSandbox(t)},t}(),e=/*#__PURE__*/function(){function t(){}return t.onEventFromSandbox=function(t){this.chrome.onEventFromSandbox(t)},t}();function h(){window.addEventListener("message",function(t){e.onEventFromSandbox(t.data)},!1)}e.chrome=new u;var c=e;export{c as TJ,h as listenForSandboxEvents};
//# sourceMappingURL=tj-comm.module.js.map
