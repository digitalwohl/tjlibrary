!function(n,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((n||self).tjComm={})}(this,function(n){function t(n,i){return t=Object.setPrototypeOf||function(n,t){return n.__proto__=t,n},t(n,i)}let i=n=>crypto.getRandomValues(new Uint8Array(n));var o=/*#__PURE__*/function(){function n(n,t,i){this.id=void 0,this.domain=void 0,this.action=void 0,this.data=void 0,this.domain=n,this.action=t,this.data=i,this.id=this.generateId()}return n.prototype.generateId=function(){return((n,t,i)=>{let o=(2<<Math.log(n.length-1)/Math.LN2)-1,e=-~(1.6*o*16/n.length);return()=>{let t="";for(;;){let s=i(e),r=e;for(;r--;)if(t+=n[s[r]&o]||"",16===t.length)return t}}})("1234567890",0,i)()},n}(),e=/*#__PURE__*/function(){function n(){this.PARENT_TARGET_ORIGIN="https://localhost/tabjail/sandbox"}return n.prototype.sendSandboxEvent=function(n){window.parent.postMessage(n,this.PARENT_TARGET_ORIGIN)},n}(),s=/*#__PURE__*/function(){function n(n){this.resolve=void 0,this.reject=void 0,this.sandboxEvent=void 0,this.sandboxEvent=n}var t=n.prototype;return t.createPromise=function(){var n=this;return new Promise(function(t,i){n.resolve=t,n.reject=i})},t.resolvePromise=function(n){this.resolve(n)},t.rejectPromise=function(n){this.reject(n)},n}(),r=/*#__PURE__*/function(n){var i,e;function r(){for(var t,i=arguments.length,o=new Array(i),e=0;e<i;e++)o[e]=arguments[e];return(t=n.call.apply(n,[this].concat(o))||this).DOMAIN="extension",t.ACTIONS={GET_ALL_WINDOWS:"getAllWindows",ON_BOUNDS_CHANGED_WINDOWS:"onBoundsChangedWindows",ON_CREATED_WINDOWS:"onCreatedWindows",ON_FOCUS_CHANGED_WINDOWS:"onFocusChangedWindows",ON_REMOVED_WINDOWS:"onRemovedWindows"},t.pendingRequests=[],t.onBoundsChangedCallbacks=[],t.onCreatedCallbacks=[],t.onFocusChangedCallbacks=[],t.onRemovedCallbacks=[],t}e=n,(i=r).prototype=Object.create(e.prototype),i.prototype.constructor=i,t(i,e);var u=r.prototype;return u.getAll=function(){var n=new o(this.DOMAIN,this.ACTIONS.GET_ALL_WINDOWS),t=new s(n);return this.pendingRequests.push(t),this.sendSandboxEvent(n),t.createPromise()},u.onBoundsChanged=function(n){this.onBoundsChangedCallbacks.push(n)},u.onCreated=function(n){this.onCreatedCallbacks.push(n)},u.onFocusChanged=function(n){this.onFocusChangedCallbacks.push(n)},u.onRemoved=function(n){this.onRemovedCallbacks.push(n)},u.onEventFromSandbox=function(n){if(n.domain===this.DOMAIN)switch(n.action){case this.ACTIONS.GET_ALL_WINDOWS:var t=this.pendingRequests.find(function(t){return t.sandboxEvent.id===n.id}),i=this.pendingRequests.findIndex(function(t){return t.sandboxEvent.id===n.id});t&&(t.resolvePromise(n.data),this.pendingRequests.splice(i,1));break;case this.ACTIONS.ON_BOUNDS_CHANGED_WINDOWS:this.onBoundsChangedCallbacks.forEach(function(t){return t(n.data)});break;case this.ACTIONS.ON_CREATED_WINDOWS:this.onCreatedCallbacks.forEach(function(t){return t(n.data)});break;case this.ACTIONS.ON_FOCUS_CHANGED_WINDOWS:this.onFocusChangedCallbacks.forEach(function(t){return t(n.data)});break;case this.ACTIONS.ON_BOUNDS_CHANGED_WINDOWS:this.onRemovedCallbacks.forEach(function(t){return t(n.data)})}},r}(e),u=/*#__PURE__*/function(){function n(){this.windows=new r}return n.prototype.onEventFromSandbox=function(n){this.windows.onEventFromSandbox(n)},n}(),f=/*#__PURE__*/function(){function n(){}return n.onEventFromSandbox=function(n){this.chrome.onEventFromSandbox(n)},n}();f.chrome=new u,n.TJ=f,n.listenForSandboxEvents=function(){window.addEventListener("message",function(n){f.onEventFromSandbox(JSON.parse(n.data))},!1)}});
//# sourceMappingURL=tj-comm.umd.js.map
